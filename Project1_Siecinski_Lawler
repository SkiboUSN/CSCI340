/*
 ============================================================================
 Name        : test.c
 Author      : 
 Version     :
 Copyright   : Your copyright notice
 Description : Hello World in C, Ansi-style
 ============================================================================
 */

#include <stdio.h>
#include <stdlib.h>
#include <dirent.h>
struct process{
	int pid;
	int ppid;
	int cid[100];
	int cidsize;
	int vsize;
	char comm[20];
};

int main(void) {
	struct dirent *de;

	DIR *dr = opendir("/proc");

	if (dr == NULL)
	{
		printf("Couldn't open directory");
		return 0;

	}
	int pid;
	char pname[50];
	int pidlist[10000];
	int ppid;
	int vmsize;
	char cha1;
	FILE *fp;
	while ((de = readdir(dr)) != NULL)
	{
		char init [200];
		memset(init, NULL, 199);
		de-> d_name;
		strcat(init, "/proc/");
		strcat(init, (de->d_name));
		strcat(init, "/stat");
		printf("%s\n", init);
		fp = fopen(init, "r");
		if(fp == NULL)
		{
			printf("could not find stat file\n");
		}
		else
		{
			fscanf(fp, "%d %s %c %d %d %d %d %d %d", &pid, &pname, &cha1, &ppid, &vmsize,&vmsize,&vmsize,&vmsize,&vmsize);
			/*fscanf(fp, "%s", &pname);
			fscanf(fp, "%s", &cha1);
			fscanf(fp, "%d", &ppid);
			fscanf(fp, "%d %d %d %d %d", &vmsize,&vmsize,&vmsize,&vmsize,&vmsize);
			*/
			printf("%d %s %d %d\n", pid, pname, ppid, vmsize);


		}
	}

	closedir(dr);
	return 0;
}
